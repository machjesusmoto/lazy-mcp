# v0.4.2 Fixed Layout Design

## Problem
Current TUI doesn't constrain output to terminal dimensions, causing:
- Header/navigation scrolls out of view in small terminals
- Dynamic agent details panel pushes content off-screen
- Blind navigation when UI elements are hidden
- Requires mouse scrolling to see full interface

## Solution: Fixed 2-Column Layout

### Layout Structure
```
┌─────────────────────────────────────────────────────────────────────┐
│                    TERMINAL DIMENSIONS (detected at launch)         │
│  ┌───────────────────────┬──────────────────────────────────────┐  │
│  │   LEFT PANE (66%)     │      RIGHT PANE (33%)               │  │
│  │                       │  ┌────────────────────────────────┐ │  │
│  │  ┌─────────────────┐  │  │  HEADER (Fixed)               │ │  │
│  │  │  Unified List   │  │  │  • Title Bar                  │ │  │
│  │  │  (Scrollable)   │  │  │  • Context Summary            │ │  │
│  │  │                 │  │  │  • Navigation Guide           │ │  │
│  │  │  [Server Icon]  │  │  └────────────────────────────────┘ │  │
│  │  │  [Memory Icon]  │  │                                      │  │
│  │  │  [Agent Icon]   │  │  ┌────────────────────────────────┐ │  │
│  │  │  ...            │  │  │  DETAILS (Scrollable)         │ │  │
│  │  │                 │  │  │                               │ │  │
│  │  │  Arrow keys to  │  │  │  Selected item details        │ │  │
│  │  │  navigate       │  │  │  • Full description          │ │  │
│  │  │                 │  │  │  • Token count               │ │  │
│  │  └─────────────────┘  │  │  • Status                    │ │  │
│  │                       │  │  • Metadata                  │ │  │
│  │                       │  │                               │ │  │
│  │                       │  │  Arrow keys to scroll        │ │  │
│  │                       │  └────────────────────────────────┘ │  │
│  └───────────────────────┴──────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────┘
```

### Key Features

#### 1. Terminal Dimension Detection
- Detect terminal size at launch: `process.stdout.columns` x `process.stdout.rows`
- Lock layout to these dimensions
- No dynamic resizing (keep it simple)

#### 2. Left Pane (66% width - 2/3)
- **Unified scrollable list** of all items:
  - MCP Servers (with section header)
  - Memory Files (with section header)
  - Agents (with section header)
- **Single list navigation**: Arrow keys only, no Tab between sections
- **Compact display**: One line per item
  - Icon/indicator (✓/✗ for status)
  - Type badge ([S]/[M]/[A])
  - Name (truncated if needed with ...)
  - Source indicator (local/global/project/user)
- **No expand/collapse**: Maximize horizontal space
- **Scrolling**: Arrow keys scroll within visible area

#### 3. Right Pane (33% width - 1/3)

##### Top Section: Header (Fixed, ~6-8 lines)
```
┌────────────────────────────┐
│ MCP Toggle                 │
│ /path/to/project          │
│ ───────────────────────────│
│ Servers: 14 active         │
│ Memory: 0 files            │
│ Agents: 56 available       │
│ Context: ~299KB            │
│ ───────────────────────────│
│ Nav: ↑/↓ List • Tab Switch│
│      Space Toggle          │
└────────────────────────────┘
```

##### Bottom Section: Details (Scrollable, remaining height)
```
┌────────────────────────────┐
│ [Selected Item Details]    │
│                            │
│ Name: sequential-thinking  │
│ Type: MCP Server          │
│ Source: Global            │
│ Status: Active            │
│ Tokens: ~39 tokens        │
│                            │
│ Description:               │
│ Multi-step reasoning...    │
│ (scroll with arrows)       │
│                            │
└────────────────────────────┘
```

#### 4. Tab Key Behavior
- **Tab**: Switch focus between Left Pane ↔ Right Pane
- **Left Pane focused**: Arrow keys navigate list
- **Right Pane focused**: Arrow keys scroll details

#### 5. Item Display Format (Left Pane)
```
✓ [S] sequential-thinking (global)
✗ [S] magic (local)
✓ [M] project-notes.md (project)
✓ [A] devops-architect (user)
```

Legend:
- ✓/✗ = Active/Blocked status
- [S]/[M]/[A] = Server/Memory/Agent type
- (global/local/project/user) = Source

#### 6. Removed Features
- ❌ Expand/collapse functionality
- ❌ Dynamic agent details in main view
- ❌ Multiple navigation guides per section
- ❌ Dynamic panel sizing
- ❌ Mouse support
- ❌ Terminal resize handling

#### 7. Scrolling Behavior
- **Left Pane**: Vertical scroll through unified list
- **Right Pane Details**: Vertical scroll through item details
- **No horizontal scroll**: Truncate long text with ellipsis
- **Visual indicators**: Show scroll position (e.g., "Line 5/20")

### Implementation Plan

1. **Terminal detection**: Capture dimensions at startup
2. **Create unified item list**: Combine servers, memory, agents
3. **Implement fixed 2-column layout**: 66/33 split
4. **Create scrollable list component**: Left pane with arrow navigation
5. **Create fixed header + scrollable details**: Right pane
6. **Implement Tab switching**: Between panes
7. **Update navigation**: Arrow keys for both list and details scroll
8. **Remove expand/collapse**: Simplify agent display
9. **Move token counts**: To details pane only
10. **Test**: Various terminal sizes (80x24, 120x40, 200x60)

### Benefits
- ✅ All UI elements always visible (no blind navigation)
- ✅ Fixed layout works in any terminal size
- ✅ Simple navigation: Arrow keys + Tab + Space
- ✅ Better use of space: No wasted vertical height
- ✅ Cleaner UX: No confusing panel switching
- ✅ Keyboard-only: No mouse required
